export interface KdpCategory {
  path: string;
  level: number;
  type: "fiction" | "nonfiction" | "juvenile_fiction" | "juvenile_nonfiction";
  parent?: string;
}

export const kdpFictionCategories: string[] = [
  "Fiction > General",
  "Fiction > Action & Adventure",
  "Fiction > African American > General",
  "Fiction > African American > Christian",
  "Fiction > African American > Contemporary Women",
  "Fiction > African American > Erotica",
  "Fiction > African American > Historical",
  "Fiction > African American > Mystery & Detective",
  "Fiction > African American > Urban",
  "Fiction > Alternative History",
  "Fiction > Amish & Mennonite",
  "Fiction > Anthologies",
  "Fiction > Asian American",
  "Fiction > Biographical",
  "Fiction > Black Humor",
  "Fiction > Christian > General",
  "Fiction > Christian > Classic & Allegory",
  "Fiction > Christian > Collections & Anthologies",
  "Fiction > Christian > Fantasy",
  "Fiction > Christian > Futuristic",
  "Fiction > Christian > Historical",
  "Fiction > Christian > Romance",
  "Fiction > Christian > Suspense",
  "Fiction > Christian > Western",
  "Fiction > Classics",
  "Fiction > Coming of Age",
  "Fiction > Contemporary Women",
  "Fiction > Crime",
  "Fiction > Cultural Heritage",
  "Fiction > Dystopian",
  "Fiction > Erotica",
  "Fiction > Fairy Tales, Folk Tales, Legends & Mythology",
  "Fiction > Family Life",
  "Fiction > Fantasy > General",
  "Fiction > Fantasy > Collections & Anthologies",
  "Fiction > Fantasy > Contemporary",
  "Fiction > Fantasy > Dark Fantasy",
  "Fiction > Fantasy > Epic",
  "Fiction > Fantasy > Historical",
  "Fiction > Fantasy > Paranormal",
  "Fiction > Fantasy > Urban",
  "Fiction > Gay",
  "Fiction > Ghost",
  "Fiction > Gothic",
  "Fiction > Hispanic & Latino",
  "Fiction > Historical",
  "Fiction > Holidays",
  "Fiction > Horror",
  "Fiction > Humorous",
  "Fiction > Jewish",
  "Fiction > Legal",
  "Fiction > Lesbian",
  "Fiction > Literary",
  "Fiction > Magical Realism",
  "Fiction > Mashups",
  "Fiction > Media Tie-In",
  "Fiction > Medical",
  "Fiction > Mystery & Detective > General",
  "Fiction > Mystery & Detective > Collections & Anthologies",
  "Fiction > Mystery & Detective > Cozy",
  "Fiction > Mystery & Detective > Hard-Boiled",
  "Fiction > Mystery & Detective > Historical",
  "Fiction > Mystery & Detective > International Mystery & Crime",
  "Fiction > Mystery & Detective > Police Procedural",
  "Fiction > Mystery & Detective > Private Investigators",
  "Fiction > Mystery & Detective > Traditional British",
  "Fiction > Mystery & Detective > Women Sleuths",
  "Fiction > Native American & Aboriginal",
  "Fiction > Noir",
  "Fiction > Occult & Supernatural",
  "Fiction > Political",
  "Fiction > Psychological",
  "Fiction > Religious",
  "Fiction > Romance > General",
  "Fiction > Romance > African American",
  "Fiction > Romance > Collections & Anthologies",
  "Fiction > Romance > Contemporary",
  "Fiction > Romance > Erotica",
  "Fiction > Romance > Fantasy",
  "Fiction > Romance > Gay",
  "Fiction > Romance > Historical > General",
  "Fiction > Romance > Historical > 20th Century",
  "Fiction > Romance > Historical > Ancient World",
  "Fiction > Romance > Historical > Medieval",
  "Fiction > Romance > Historical > Regency",
  "Fiction > Romance > Historical > Scottish",
  "Fiction > Romance > Historical > Victorian",
  "Fiction > Romance > Historical > Viking",
  "Fiction > Romance > Lesbian",
  "Fiction > Romance > Military",
  "Fiction > Romance > Multicultural & Interracial",
  "Fiction > Romance > New Adult",
  "Fiction > Romance > Paranormal",
  "Fiction > Romance > Romantic Comedy",
  "Fiction > Romance > Science Fiction",
  "Fiction > Romance > Suspense",
  "Fiction > Romance > Time Travel",
  "Fiction > Romance > Western",
  "Fiction > Sagas",
  "Fiction > Satire",
  "Fiction > Science Fiction > General",
  "Fiction > Science Fiction > Action & Adventure",
  "Fiction > Science Fiction > Alien Contact",
  "Fiction > Science Fiction > Apocalyptic & Post-Apocalyptic",
  "Fiction > Science Fiction > Collections & Anthologies",
  "Fiction > Science Fiction > Cyberpunk",
  "Fiction > Science Fiction > Genetic Engineering",
  "Fiction > Science Fiction > Hard Science Fiction",
  "Fiction > Science Fiction > Military",
  "Fiction > Science Fiction > Space Opera",
  "Fiction > Science Fiction > Steampunk",
  "Fiction > Science Fiction > Time Travel",
  "Fiction > Sea Stories",
  "Fiction > Short Stories",
  "Fiction > Sports",
  "Fiction > Superheroes",
  "Fiction > Thrillers > General",
  "Fiction > Thrillers > Crime",
  "Fiction > Thrillers > Espionage",
  "Fiction > Thrillers > Historical",
  "Fiction > Thrillers > Legal",
  "Fiction > Thrillers > Medical",
  "Fiction > Thrillers > Military",
  "Fiction > Thrillers > Political",
  "Fiction > Thrillers > Supernatural",
  "Fiction > Thrillers > Suspense",
  "Fiction > Thrillers > Technological",
  "Fiction > Urban",
  "Fiction > Visionary & Metaphysical",
  "Fiction > War & Military",
  "Fiction > Westerns",
  "Fiction > Yaoi Light Novels > General",
  "Fiction > Yaoi Light Novels > Boys' Love Novels",
];

export const kdpNonfictionCategories: string[] = [
  "Nonfiction > Architecture",
  "Nonfiction > Art > General",
  "Nonfiction > Art > History",
  "Nonfiction > Art > Criticism",
  "Nonfiction > Art > Techniques",
  "Nonfiction > Biography & Autobiography > General",
  "Nonfiction > Biography & Autobiography > Artists & Musicians",
  "Nonfiction > Biography & Autobiography > Business",
  "Nonfiction > Biography & Autobiography > Historical",
  "Nonfiction > Biography & Autobiography > Literary",
  "Nonfiction > Biography & Autobiography > Personal Memoirs",
  "Nonfiction > Biography & Autobiography > Political",
  "Nonfiction > Biography & Autobiography > Religious",
  "Nonfiction > Biography & Autobiography > Sports",
  "Nonfiction > Business & Economics > General",
  "Nonfiction > Business & Economics > Accounting",
  "Nonfiction > Business & Economics > Careers",
  "Nonfiction > Business & Economics > Economics",
  "Nonfiction > Business & Economics > Entrepreneurship",
  "Nonfiction > Business & Economics > Finance",
  "Nonfiction > Business & Economics > International",
  "Nonfiction > Business & Economics > Investing",
  "Nonfiction > Business & Economics > Leadership",
  "Nonfiction > Business & Economics > Management",
  "Nonfiction > Business & Economics > Marketing",
  "Nonfiction > Business & Economics > Personal Finance",
  "Nonfiction > Business & Economics > Real Estate",
  "Nonfiction > Business & Economics > Small Business",
  "Nonfiction > Computers & Technology > General",
  "Nonfiction > Computers & Technology > Internet",
  "Nonfiction > Computers & Technology > Programming",
  "Nonfiction > Computers & Technology > Software",
  "Nonfiction > Cooking, Food & Wine > General",
  "Nonfiction > Cooking, Food & Wine > Baking",
  "Nonfiction > Cooking, Food & Wine > Beverages",
  "Nonfiction > Cooking, Food & Wine > Courses & Dishes",
  "Nonfiction > Cooking, Food & Wine > Health & Healing",
  "Nonfiction > Cooking, Food & Wine > Methods",
  "Nonfiction > Cooking, Food & Wine > Regional & Ethnic",
  "Nonfiction > Cooking, Food & Wine > Special Diet",
  "Nonfiction > Cooking, Food & Wine > Specific Ingredients",
  "Nonfiction > Crafts & Hobbies > General",
  "Nonfiction > Crafts & Hobbies > Crafts",
  "Nonfiction > Crafts & Hobbies > Games",
  "Nonfiction > Crafts & Hobbies > Hobbies",
  "Nonfiction > Education & Teaching > General",
  "Nonfiction > Education & Teaching > Elementary",
  "Nonfiction > Education & Teaching > Higher Education",
  "Nonfiction > Education & Teaching > Homeschooling",
  "Nonfiction > Education & Teaching > Special Education",
  "Nonfiction > Family & Relationships > General",
  "Nonfiction > Family & Relationships > Adoption",
  "Nonfiction > Family & Relationships > Aging",
  "Nonfiction > Family & Relationships > Children",
  "Nonfiction > Family & Relationships > Divorce",
  "Nonfiction > Family & Relationships > Marriage",
  "Nonfiction > Family & Relationships > Parenting",
  "Nonfiction > Health, Fitness & Dieting > General",
  "Nonfiction > Health, Fitness & Dieting > Addiction",
  "Nonfiction > Health, Fitness & Dieting > Aging",
  "Nonfiction > Health, Fitness & Dieting > Alternative Medicine",
  "Nonfiction > Health, Fitness & Dieting > Beauty & Grooming",
  "Nonfiction > Health, Fitness & Dieting > Diets",
  "Nonfiction > Health, Fitness & Dieting > Diseases",
  "Nonfiction > Health, Fitness & Dieting > Exercise",
  "Nonfiction > Health, Fitness & Dieting > Mental Health",
  "Nonfiction > Health, Fitness & Dieting > Nutrition",
  "Nonfiction > Health, Fitness & Dieting > Pregnancy",
  "Nonfiction > Health, Fitness & Dieting > Psychology",
  "Nonfiction > Health, Fitness & Dieting > Women's Health",
  "Nonfiction > History > General",
  "Nonfiction > History > Africa",
  "Nonfiction > History > Americas",
  "Nonfiction > History > Ancient",
  "Nonfiction > History > Asia",
  "Nonfiction > History > Europe",
  "Nonfiction > History > Middle East",
  "Nonfiction > History > Military",
  "Nonfiction > History > World",
  "Nonfiction > Humor & Entertainment > General",
  "Nonfiction > Humor & Entertainment > Comedy",
  "Nonfiction > Humor & Entertainment > Essays",
  "Nonfiction > Humor & Entertainment > Movies",
  "Nonfiction > Humor & Entertainment > Music",
  "Nonfiction > Humor & Entertainment > Pop Culture",
  "Nonfiction > Humor & Entertainment > Television",
  "Nonfiction > Law > General",
  "Nonfiction > Law > Business",
  "Nonfiction > Law > Constitutional",
  "Nonfiction > Law > Criminal",
  "Nonfiction > Law > Family",
  "Nonfiction > Law > Immigration",
  "Nonfiction > Law > Intellectual Property",
  "Nonfiction > Literary Criticism > General",
  "Nonfiction > Literary Criticism > American",
  "Nonfiction > Literary Criticism > British",
  "Nonfiction > Literary Criticism > European",
  "Nonfiction > Literary Criticism > World",
  "Nonfiction > Medical > General",
  "Nonfiction > Medical > Allied Health",
  "Nonfiction > Medical > Anatomy",
  "Nonfiction > Medical > Diseases",
  "Nonfiction > Medical > Nursing",
  "Nonfiction > Medical > Pharmacy",
  "Nonfiction > Medical > Surgery",
  "Nonfiction > Music > General",
  "Nonfiction > Music > Genres",
  "Nonfiction > Music > Instruction",
  "Nonfiction > Music > Theory",
  "Nonfiction > Nature & Ecology > General",
  "Nonfiction > Nature & Ecology > Animals",
  "Nonfiction > Nature & Ecology > Environment",
  "Nonfiction > Nature & Ecology > Plants",
  "Nonfiction > Parenting & Relationships > General",
  "Nonfiction > Parenting & Relationships > Adoption",
  "Nonfiction > Parenting & Relationships > Child Care",
  "Nonfiction > Parenting & Relationships > Family Activities",
  "Nonfiction > Parenting & Relationships > Parenting",
  "Nonfiction > Philosophy > General",
  "Nonfiction > Philosophy > Ethics",
  "Nonfiction > Philosophy > History",
  "Nonfiction > Philosophy > Logic",
  "Nonfiction > Philosophy > Metaphysics",
  "Nonfiction > Politics & Social Sciences > General",
  "Nonfiction > Politics & Social Sciences > Anthropology",
  "Nonfiction > Politics & Social Sciences > Civics",
  "Nonfiction > Politics & Social Sciences > Government",
  "Nonfiction > Politics & Social Sciences > Political Science",
  "Nonfiction > Politics & Social Sciences > Sociology",
  "Nonfiction > Reference > General",
  "Nonfiction > Reference > Almanacs",
  "Nonfiction > Reference > Atlases",
  "Nonfiction > Reference > Dictionaries",
  "Nonfiction > Reference > Encyclopedias",
  "Nonfiction > Reference > Etiquette",
  "Nonfiction > Reference > Writing",
  "Nonfiction > Religion & Spirituality > General",
  "Nonfiction > Religion & Spirituality > Buddhism",
  "Nonfiction > Religion & Spirituality > Christianity",
  "Nonfiction > Religion & Spirituality > Hinduism",
  "Nonfiction > Religion & Spirituality > Islam",
  "Nonfiction > Religion & Spirituality > Judaism",
  "Nonfiction > Religion & Spirituality > New Age",
  "Nonfiction > Religion & Spirituality > Spirituality",
  "Nonfiction > Science & Mathematics > General",
  "Nonfiction > Science & Mathematics > Astronomy",
  "Nonfiction > Science & Mathematics > Biology",
  "Nonfiction > Science & Mathematics > Chemistry",
  "Nonfiction > Science & Mathematics > Earth Sciences",
  "Nonfiction > Science & Mathematics > Mathematics",
  "Nonfiction > Science & Mathematics > Physics",
  "Nonfiction > Self-Help > General",
  "Nonfiction > Self-Help > Anger Management",
  "Nonfiction > Self-Help > Anxiety",
  "Nonfiction > Self-Help > Communication",
  "Nonfiction > Self-Help > Creativity",
  "Nonfiction > Self-Help > Death & Grief",
  "Nonfiction > Self-Help > Emotions",
  "Nonfiction > Self-Help > Happiness",
  "Nonfiction > Self-Help > Motivation",
  "Nonfiction > Self-Help > Personal Growth",
  "Nonfiction > Self-Help > Relationships",
  "Nonfiction > Self-Help > Self-Esteem",
  "Nonfiction > Self-Help > Stress Management",
  "Nonfiction > Self-Help > Success",
  "Nonfiction > Self-Help > Time Management",
  "Nonfiction > Sports & Outdoors > General",
  "Nonfiction > Sports & Outdoors > Baseball",
  "Nonfiction > Sports & Outdoors > Basketball",
  "Nonfiction > Sports & Outdoors > Cycling",
  "Nonfiction > Sports & Outdoors > Extreme Sports",
  "Nonfiction > Sports & Outdoors > Fishing",
  "Nonfiction > Sports & Outdoors > Football",
  "Nonfiction > Sports & Outdoors > Golf",
  "Nonfiction > Sports & Outdoors > Hiking",
  "Nonfiction > Sports & Outdoors > Hunting",
  "Nonfiction > Sports & Outdoors > Martial Arts",
  "Nonfiction > Sports & Outdoors > Outdoor Recreation",
  "Nonfiction > Sports & Outdoors > Running",
  "Nonfiction > Sports & Outdoors > Soccer",
  "Nonfiction > Sports & Outdoors > Water Sports",
  "Nonfiction > Travel > General",
  "Nonfiction > Travel > Africa",
  "Nonfiction > Travel > Americas",
  "Nonfiction > Travel > Asia",
  "Nonfiction > Travel > Australia & Oceania",
  "Nonfiction > Travel > Caribbean",
  "Nonfiction > Travel > Central America",
  "Nonfiction > Travel > Europe",
  "Nonfiction > Travel > Middle East",
  "Nonfiction > Travel > South America",
  "Nonfiction > Travel > United States",
  "Nonfiction > True Crime > General",
  "Nonfiction > True Crime > Espionage",
  "Nonfiction > True Crime > Heists",
  "Nonfiction > True Crime > Murder",
  "Nonfiction > True Crime > Organized Crime",
  "Nonfiction > True Crime > Serial Killers",
  "Nonfiction > True Crime > White Collar Crime",
];

export const kdpJuvenileCategories: string[] = [
  "Juvenile Fiction > Action & Adventure",
  "Juvenile Fiction > Animals",
  "Juvenile Fiction > Classics",
  "Juvenile Fiction > Comics & Graphic Novels",
  "Juvenile Fiction > Coming of Age",
  "Juvenile Fiction > Dystopian",
  "Juvenile Fiction > Fairy Tales & Folklore",
  "Juvenile Fiction > Family",
  "Juvenile Fiction > Fantasy & Magic",
  "Juvenile Fiction > Historical",
  "Juvenile Fiction > Horror",
  "Juvenile Fiction > Humor",
  "Juvenile Fiction > LGBTQ+",
  "Juvenile Fiction > Mystery & Detective",
  "Juvenile Fiction > Religious",
  "Juvenile Fiction > Romance",
  "Juvenile Fiction > Science Fiction",
  "Juvenile Fiction > Social Issues",
  "Juvenile Fiction > Sports & Recreation",
  "Juvenile Fiction > Thrillers & Suspense",
  "Juvenile Nonfiction > Activity Books",
  "Juvenile Nonfiction > Animals",
  "Juvenile Nonfiction > Biography & Autobiography",
  "Juvenile Nonfiction > Crafts & Hobbies",
  "Juvenile Nonfiction > Education & Reference",
  "Juvenile Nonfiction > Health & Daily Living",
  "Juvenile Nonfiction > History",
  "Juvenile Nonfiction > Humor",
  "Juvenile Nonfiction > Language Arts",
  "Juvenile Nonfiction > Mathematics",
  "Juvenile Nonfiction > Music",
  "Juvenile Nonfiction > Nature & Environment",
  "Juvenile Nonfiction > Reference",
  "Juvenile Nonfiction > Religion",
  "Juvenile Nonfiction > Science & Technology",
  "Juvenile Nonfiction > Social Issues",
  "Juvenile Nonfiction > Sports & Recreation",
  "Juvenile Nonfiction > Technology",
  "Juvenile Nonfiction > Transportation",
];

export const allKdpCategories: string[] = [
  ...kdpFictionCategories,
  ...kdpNonfictionCategories,
  ...kdpJuvenileCategories,
];

export function findMatchingCategories(
  genre: string,
  themes: string[],
  isFiction: boolean,
  limit: number = 10
): string[] {
  const searchTerms = [genre, ...themes].map(t => t.toLowerCase());
  const categoryList = isFiction ? kdpFictionCategories : kdpNonfictionCategories;
  
  const scored = categoryList.map(category => {
    const lowerCategory = category.toLowerCase();
    let score = 0;
    
    for (const term of searchTerms) {
      if (lowerCategory.includes(term)) {
        score += 10;
        if (lowerCategory.split(" > ").pop()?.includes(term)) {
          score += 5;
        }
      }
    }
    
    const depth = category.split(" > ").length;
    score += depth * 2;
    
    return { category, score };
  });
  
  return scored
    .filter(s => s.score > 0)
    .sort((a, b) => b.score - a.score)
    .slice(0, limit)
    .map(s => s.category);
}

export function getCategoryPath(category: string): string {
  return category.replace(/ > /g, " > ");
}

export function getCategoryDepth(category: string): number {
  return category.split(" > ").length;
}

export function getParentCategory(category: string): string | null {
  const parts = category.split(" > ");
  if (parts.length <= 1) return null;
  return parts.slice(0, -1).join(" > ");
}

export function getSubcategories(parentCategory: string, categoryList: string[]): string[] {
  return categoryList.filter(cat => 
    cat.startsWith(parentCategory + " > ") && 
    cat.split(" > ").length === parentCategory.split(" > ").length + 1
  );
}
